<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">

<head>
    <meta charset="UTF-8" />
    <!-- inner -->
    <link rel="manifest" href="/manifest.json" />
    <link rel="dns-prefetch" href="//img.gifmagazine.net" />
    <title>GIFメーカー (動画,画像,youtubeから変換作成) - GIFMAGAZINE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="keywords" content="GIF,作成,変換,作り方,アニメ,画像,動画,ジフ,オンライン,無料,フリー,ソフト,アプリ,イラスト,素材,スタンプ,レス画像" />
    <meta name="description" content="30秒で完成する最も簡単なGIFの作り方はこちら。完全無料でアプリのインストールや新規登録せずにジフが作成可能。mp4,wmv,webm,movなどの動画を加工編集してＧＩＦアニメを制作することができます。" />
    <meta name="copyright" content="GIFMAGAZINE" />
    <meta name="author" content="GIFMAGAZINE" />
    <meta name="format-detection" content="telephone=no" />

    <!-- Facebook SEO -->
    <meta name="facebook-domain-verification" content="38ozg8itvcy0kzci8iockarq5ynt7d" />
    <meta property="fb:app_id" content="1045379895490324" />
    <meta property="og:site_name" content="GIFMAGAZINE" />
    <meta property="og:title" content="GIFメーカー (動画,画像,youtubeから変換作成) - GIFMAGAZINE" />
    <meta property="og:description" content="30秒で完成する最も簡単なGIFの作り方はこちら。完全無料でアプリのインストールや新規登録せずにジフが作成可能。mp4,wmv,webm,movなどの動画を加工編集してＧＩＦアニメを制作することができます。" />
    <meta property="og:url" content="https://gifmagazine.net/converters/movie_to_gif?locale=ja" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://img.gifmagazine.net/gifmagazine/000assets/images/v2/sns_ogp.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />

    <!-- Twitter Card SEO -->
    <meta name="twitter:site" content="@gifmagazine" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="GIFMAGAZINE" />
    <meta name="twitter:creator" content="@gifmagazine" />
    <meta name="twitter:description" content="30秒で完成する最も簡単なGIFの作り方はこちら。完全無料でアプリのインストールや新規登録せずにジフが作成可能。mp4,wmv,webm,movなどの動画を加工編集してＧＩＦアニメを制作することができます。" />
    <meta name="twitter:image:src" content="https://img.gifmagazine.net/gifmagazine/000assets/images/v2/sns_ogp.png" />
    <meta name="twitter:domain" content="gifmagazine.net" />

    <meta name="google-site-verification" content="3zterLFmS1hIqrVrDUeMxt-5jA5doIVwV_kkWVWYT2Y" />
    <meta name="inmobi-site-verification" content="ef4e599ada6159d8ed826e655ea06b32" />
    <meta name="p:domain_verify" content="c0fdbbb8128849c3a0164c93b2d69ed2" />
    <meta name="msvalidate.01" content="76AC25CAA940A67334D928A4B966786C" />

    <link rel="canonical" href="https://gifmagazine.net/converters/movie_to_gif" />

    <link rel="apple-touch-icon" href="https://img.gifmagazine.net/gifmagazine/000assets/images/v2/appicon.png" />
    <link rel="shortcut icon" href="https://img.gifmagazine.net/gifmagazine/000assets/images/v2/favicon.png" />
    <link rel="stylesheet" media="all" href="https://img.gifmagazine.net/gifmagazine/assets/application-4062cf09b9f0f8a53358c696ccd7f7a4454373ff1bf6b0d782a6b365f390a4cc.css" />
    <script type="text/javascript" id="www-widgetapi-script" src="https://www.youtube.com/s/player/4248d311/www-widgetapi.vflset/www-widgetapi.js" async=""></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <script async="" src="//www.google-analytics.com/analytics.js"></script>
    <script src="https://img.gifmagazine.net/gifmagazine/assets/application-f00e42ffd3c92ab03643175ce48013b25ae5bd6c839132fb052b9fd52f720a59.js"></script>
    <meta name="csrf-param" content="authenticity_token" />
    <meta name="csrf-token" content="1t5YKYw9K2jLj9NBM+4+TSV9LKZeXPfOrQlfvdwJF4D23QuRChMvev04WtaNsKcBTuYneVqGJ5RsQaYxgDvI/A==" />

    <!--GA-->
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-43980601-2', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- exception tracking -->
    <script>
        try {
            var isIncompatibleBrowser = function() {
                var ua = navigator.userAgent.toLowerCase();
                var ver = navigator.appVersion.toLowerCase();
                var MSIE = (ua.indexOf('msie') & gt; - 1) & amp; & amp;
                (ua.indexOf('opera') == -1);
                var IE6 = (ver.indexOf('msie 6.') & gt; - 1);
                var IE7 = (ver.indexOf('msie 7.') & gt; - 1);
                var IE8 = (ver.indexOf('msie 8.') & gt; - 1);
                var IE9 = (ver.indexOf('msie 9.') & gt; - 1);
                var Nintendo = (ver.indexOf('nintendo') & gt; - 1);
                return MSIE & amp; & amp;
                (IE6 || IE7 || IE8 || IE9 || Nintendo) ? true: false;
            }

            var gifmagazineLineNumber = function() {
                var e = new Error();
                if (!e.stack) try {
                    throw e;
                } catch (e) {
                    if (!e.stack) {
                        return 0;
                    }
                }
                var stack = e.stack.toString().split(/\r\n|\n/);
                var frameRE = /:(\d+):(?:\d+)[^\d]*$/;
                do {
                    var frame = stack.shift();
                } while (!frameRE.exec(frame) & amp; & amp; stack.length);
                return frameRE.exec(stack.shift())[1];
            }

            var errorTrackingToGa = function(errorMsg, fileName, lineNumber) {
                if (isIncompatibleBrowser()) return;
                var errorDesc = "fileName" + ':' + fileName + "\tlineNumber" + ':' + lineNumber + "\turlDispPage" + ':' + location.href + "\tuserAgent" + ':' + navigator.userAgent + "\terrorMsg" + ':' + errorMsg;
                ga('send', 'exception', {
                    'exDescription': errorDesc
                });
            };

            window.onerror = function(e, f, l) {
                errorTrackingToGa(e, f, l);
            }
        } catch (e) {}
    </script>

    <!-- inview -->
    <script type="text/javascript">
        function handleInview(that, event, isInView, visiblePartX, visiblePartY) {
            if (isInView) {
                // img shower
                $(that).find('.detial20160502-wrap-main-body-left-container a img').addClass('show');
                $(that).find('.detial20160502-wrap-main-body-left-container a img').removeClass('hide');

                if (visiblePartY == 'top' || visiblePartY == 'both') {
                    // remove network ad, hike and tlad imps from organic imps
                    if ($(that).hasClass('related_infinite_scroll_sp') ||
                        $(that).hasClass('inline-ad') ||
                        $(that).hasClass('300x250_related_top') ||
                        $(that).hasClass('related_infinite_scroll_sp_hike') ||
                        $(that).hasClass('detial20160825-wrap-list-feedad')) {
                        return false;
                    }

                    var eventTitle = 'path:' + location.pathname + (location.search.replace(/&amp;commit.+/, '')) + " id:" + $(that).attr('data-id') + ' ref:' + document.referrer;
                    ga('send', 'event', 'impression', 'view', eventTitle);
                    sendTLADLog(that, 'imp', 'organic');
                }
            }
        }

        function handleInviewDFP(that, event, isInView, visiblePartX, visiblePartY) {
            var $ad = $(that).next().next().next();
            $ad.css('text-align', 'center');
            loadNextContent($ad.get(0));
        }

        function handleInviewTlAdImp(that, event, isInView, visiblePartX, visiblePartY) {
            try {
                if (isInView) {
                    if (visiblePartY == 'top' || visiblePartY == 'both') {
                        sendTLADLog(that, 'imp');
                    }
                }
            } catch (e) {}
        }

        function handleInviewTlAdLoop(that) {
            try {
                sendTLADLog(that, 'loop');
            } catch (e) {}
        }

        var sendTLADLogTimer;

        function sendTLADLog(elm, eventType, eventCategory = 'tlad') {
            // params element
            var $paramsElm = $(elm).find('.detial20160825-wrap-list-feedad-prms');

            // coloring action bar
            if (eventType == 'imp' & amp; & amp; eventCategory == 'tlad') {
                clearTimeout(sendTLADLogTimer);
                sendTLADLogTimer = setTimeout(function() {
                    $('.detial20160825-wrap-main-body-right-container-content-meta-action').removeClass('viewing');
                    $(elm).find('.detial20160825-wrap-main-body-right-container-content-meta-action').addClass('viewing');
                }, 1000);
            }

            // lazyload
            var img = $(elm).find(".home20160502-wrap-list-top-link img");
            if (img & amp; & amp; $(img).attr("src") !== $(img).attr("data-original")) {
                $(img).attr("src", $(img).attr("data-original"));
            }

            // send imp log to server
            var pLocation = encodeURIComponent(window.location.pathname + (window.location.search.replace(/&amp;commit.+/, '')));
            var link = $paramsElm.attr('data-link');
            var gid = $paramsElm.attr('data-gid');
            var uid = $paramsElm.attr('data-uid');
            var oid = $paramsElm.attr('data-oid');
            var label = 'post_images_' + gid;
            var altReferrer = document.referrer;
            var logUrl = "https://log.gifmagazine.net/gm/ad/collect" + "?category=" + eventCategory + "&amp;evtAction=" + eventType + "&amp;label=" + label + "&amp;location=" + pLocation + "&amp;link=" + link + "&amp;gid=" + gid + "&amp;uid=" + uid + "&amp;oid=" + oid + "&amp;altReferrer=" + altReferrer;
            new Image().src = logUrl;
        }
    </script>


</head>

<body id="custom-global">
    <div id="wrapper">
        <div id="header-common-wrap">
            <!---->
            <section id="header-gifmagazine-logo"><a href="/?locale=ja"><img alt="GIFMAGAZINE" src="https://img.gifmagazine.net/gifmagazine/000assets/images/v2/gifmagazine_logo.png" /></a></section> <button id="header-searchbox-opener"><input type="search" placeholder="GIFを検索" /> <i aria-hidden="true" class="fa fa-search"></i></button>
            <section id="header-searchbox" style="z-index: -1;">
                <form action="/gifs/search_results?locale=ja" accept-charset="UTF-8" method="get"><input type="search" name="search[word]" autocomplete="off" placeholder="GIFを検索" />
                    <!----> <input type="hidden" name="query_type" value="query" /> <button id="header-searchbox-closer" type="button"><i class="fa fa-search"></i></button>
                </form>
                <section id="header-searchbox-suggests" class="header-searchbox-contents" style="display: none;">
                    <ul class="tags"></ul>
                    <h2 style="display: none;">チャンネル</h2>
                    <ul class="users"></ul>
                </section>
                <section id="header-searchbox-searches" class="header-searchbox-contents" style="display: none;">
                    <h2>トレンド</h2>
                    <ul class="trends"></ul>
                    <ul class="trends">
                        <li><a><i aria-hidden="true" class="fa fa-spinner fa-spin"></i></a></li>
                        <li><a><i aria-hidden="true" class="fa fa-spinner fa-spin"></i></a></li>
                        <li><a><i aria-hidden="true" class="fa fa-spinner fa-spin"></i></a></li>
                    </ul>
                    <h2>人気チャンネル</h2>
                    <ul class="users"></ul>
                    <h2 style="display: none;">
                        履歴
                        <button><i aria-hidden="true" class="fa fa-times"></i></button>
                    </h2>
                    <ul class="histories"></ul>
                </section>
            </section>
            <!---->
            <nav id="header-pc-menu">
                <ul class="gm-horizontal-list no-scroll">
                    <li class="list-element"><button class="gm-button upload">
                            投稿
                            <i aria-hidden="true" class="fa fa-plus"></i></button></li>
                    <li class="list-element"><button class="gm-button login-button"><a href="/users/sign_in?locale=ja">ログイン</a></button></li>
                </ul>
            </nav>
            <!---->
            <div class="overlay"></div>
        </div>

        <script>
            new Vue({
                el: '#header-common-wrap',
                data: {
                    locale: null,
                    searchWord: '',
                    searchHistories: [],
                    searchTrends: [],
                    popularUsers: [],
                    suggestTags: [],
                    selectedSuggestTags: [],
                    selectedSuggestTagIndex: null,
                    selectedSuggestUsers: [],
                    isDrawerActive: false,
                    isPcModalActive: false,
                    isPcUpdialogActive: false,
                    isNotificationActive: false,
                    isSearchboxActive: false,
                    isSearchboxFocused: false,
                    isSearchboxLoaded: false,
                    scrollTimeoutId: 0,
                    // 以下通知モーダル用・リニューアル完了後に削除予定
                    tab: 0,
                    popupOpening: {
                        notification: false
                    },
                    ntfItems: [],
                    existNonCheckedVisitor: false,
                },
                created: function() {
                    var vm = this;
                    var localeMatch = location.search.match(/locale=(.*?)(&amp;|$)/);
                    if (localeMatch) vm.locale = decodeURIComponent(localeMatch[1]) || '';
                },
                mounted: function() {
                    window.addEventListener('scroll', this._calcScroll, {
                        passive: true
                    });
                    this._checkUnreadVisitor();
                    this._hideSnackNotice();
                },
                destroyed: function() {
                    window.removeEventListener('scroll', this._calcScroll, {
                        passive: true
                    });
                },
                computed: {
                    isOverlayActive: function() {
                        return this.isDrawerActive ||
                            (!this.$isNarrowDevice & amp; & amp; this.isSearchboxActive) ||
                            this.isPcModalActive ||
                            this.isPcUpdialogActive ||
                            this.isNotificationActive;
                    },
                    headerSearchboxZIndex: function() {
                        return this.isSearchboxActive ? 1 : -1;
                    }
                },
                watch: {
                    searchWord: function(searchWord) {
                        const vm = this;
                        if (!searchWord) {
                            this.selectedSuggestTags = [];
                            return;
                        }
                        axios({
                            methos: 'get',
                            url: '/gifs/suggest_users' + vm.$queryString,
                            params: {
                                query: searchWord
                            }
                        }).then(function(resp) {
                            vm.selectedSuggestUsers = resp.data;
                        });
                    },
                    // 以下通知モーダル用・リニューアル完了後に削除予定
                    "popupOpening.notification": function() {
                        this.handlePopupScroll();
                    }
                },
                methods: {
                    closeOverlay: function() {
                        this.isDrawerActive = false;
                        this.isPcModalActive = false;
                        this.isPcUpdialogActive = false;
                        this.isNotificationActive = false;
                        this.closeSearchbox();
                    },
                    openSearchbox: function() {
                        this.isSearchboxActive = true;
                        if (!this.isSearchboxLoaded) {
                            // 負荷軽減のため検索ボックスが開かれてから呼び出す
                            this._initSuggestTags();
                            this._initSearchbox();
                            this.isSearchboxLoaded = true;
                        }
                        this.$refs.searchboxInput.focus(); // iOSのSafariではsetTimeout内だと処理されない
                        const vm = this;
                        setTimeout(function() {
                            const tempWord = vm.searchWord;
                            vm.searchWord = '';
                            vm.$refs.searchboxInput.focus(); // ChromeではsetTimeoutを噛まさないと処理されない
                            vm.searchWord = tempWord;
                        });
                    },
                    closeSearchbox: function() {
                        this.isSearchboxActive = false;
                        this.isSearchboxFocused = false;
                        this.searchWord = '';
                        this.selectedSuggestTags = [];
                    },
                    openNotification: function() {
                        location.href = '/notifications?locale=ja';
                    },
                    searchBySuggestTag: function(event) {
                        this.searchWord = event.target.text;
                        this.search(event);
                    },
                    search: function(event) {
                        if (!this.searchWord) {
                            event.preventDefault();
                            return;
                        }
                        this._saveSearchHistories();
                        this._sendLogToGa();
                    },
                    forwardSuggestTags: function() {
                        if (this.selectedSuggestTagIndex === null || this.selectedSuggestTagIndex === this.selectedSuggestTags.length - 1) {
                            this.selectedSuggestTagIndex = 0;
                        } else {
                            this.selectedSuggestTagIndex++;
                        }
                        this.searchWord = this.selectedSuggestTags[this.selectedSuggestTagIndex].plain;
                    },
                    backwardSuggestTags: function() {
                        if (this.selectedSuggestTagIndex === null || this.selectedSuggestTagIndex === 0) {
                            this.selectedSuggestTagIndex = this.selectedSuggestTags.length - 1;
                        } else {
                            this.selectedSuggestTagIndex -= 1;
                        }
                        this.searchWord = this.selectedSuggestTags[this.selectedSuggestTagIndex].plain;
                    },
                    filterSearchWord: function(event) {
                        const types = ['Down', 'ArrowDown', 'Up', 'ArrowUp'];
                        if (types.indexOf(event.key) !== -1 || !this.searchWord) return;
                        const vm = this;
                        this.selectedSuggestTags = this.suggestTags.filter(function(suggestTag) {
                            return suggestTag.toLowerCase().indexOf(vm.searchWord.toLocaleLowerCase()) !== -1;
                        }).map(function(suggestTag) {
                            return {
                                plain: suggestTag,
                                html: suggestTag.replace(new RegExp(vm.searchWord, 'i'), function(matched) {
                                    return '&lt;span class="search-word"&gt;' + matched + '&lt;/span&gt;';
                                })
                            };
                        }).slice(0, 5);
                    },
                    clearHistories: function() {
                        this.searchHistories = [];
                        localStorage.setItem('searchHistories', JSON.stringify(this.searchHistories));
                    },
                    _initSuggestTags: function() {
                        const vm = this;
                        const now = new Date();
                        if (new Date(localStorage.getItem('suggestTagsExpiredAt')) & gt; now) {
                            vm.suggestTags = JSON.parse(localStorage.getItem('suggestTags')) || [];
                            return;
                        }

                        let expiredAt = new Date();
                        expiredAt.setDate(expiredAt.getDate() + 1);

                        axios({
                            method: 'get',
                            url: '/gifs/suggest_tags' + vm.$queryString
                        }).then(function(resp) {
                            localStorage.setItem('suggestTags', JSON.stringify(resp.data));
                            localStorage.setItem('suggestTagsExpiredAt', expiredAt.toISOString());
                            vm.suggestTags = resp.data || [];
                        });
                    },
                    _initSearchbox: function() {
                        const vm = this;
                        vm.searchHistories = JSON.parse(localStorage.getItem('searchHistories')) || [];
                        axios({
                            method: 'get',
                            url: '/gifs/search_trends' + vm.$queryString
                        }).then(function(resp) {
                            vm.searchTrends = resp.data;
                        });
                        if (this.$isNarrowDevice) return;
                        axios({
                            method: 'get',
                            url: '/gifs/popular_users' + vm.$queryString
                        }).then(function(resp) {
                            vm.popularUsers = resp.data;
                        });
                    },
                    _saveSearchHistories: function() {
                        searchHistories = this.searchHistories.concat(); // そのまま使うと画面に一瞬出てしまうのでコピーする
                        searchHistories.unshift(this.searchWord);
                        searchHistories = searchHistories.filter(function(value, index, self) {
                            return self.indexOf(value) === index
                        });
                        while (searchHistories.length & gt; 10) searchHistories.pop();
                        localStorage.setItem('searchHistories', JSON.stringify(searchHistories));
                    },
                    _sendLogToGa: function() {
                        const searchWord = this.$refs.searchboxInput.value;
                        ga('send', 'event', 'engagement', 'search', searchWord + '_' + location.href.replace(location.origin, ''));
                        ga('send', 'event', 'search_engine', 'search_word', searchWord);
                    },
                    _calcScroll: function() {
                        if (!this.$isNarrowDevice) return;
                        const vm = this;
                        if (vm.scrollTimeoutId & gt; 0) return;
                        vm.scrollTimeoutId = setTimeout(function() {
                            vm.isSearchboxActive = window.scrollY & gt;
                            0 || vm.$refs.searchboxInput.value;
                            vm.scrollTimeoutId = 0;
                        }, 100);
                    },
                    _checkUnreadVisitor: function() {
                        if (this._getCookie() !== '1') {
                            this._setCookie();
                            this.existNonCheckedVisitor = true;
                        }
                    },
                    _hideSnackNotice: function() {
                        setTimeout(function() {
                            var elms = document.querySelectorAll('.snack-bar-notice')
                            for (var i = 0; i & lt; elms.length; i++) {
                                elms[i].classList.add('hide');
                            }
                        }, 10000);
                    },
                    _getCookie: function() {
                        return unescape(
                            document.cookie.replace(new RegExp("(?:^|.*;\\s*)" + escape(this._visitorCookieKey()).replace(/[\-\.\+\*]/g, "\\$&amp;") + "\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"), "$1")
                        );
                    },
                    _setCookie: function() {
                        document.cookie = this._visitorCookieKey() + '=' + '1' + '; max-age=' + (60 * 60 * 24) + ';';
                    },
                    _visitorCookieKey: function() {
                        return 'visitor_checked';
                    },
                    // 以下通知モーダル用・リニューアル完了後に削除予定
                    handlePopupScroll: function() {
                        if (this.popupOpening.notification === true) {
                            document.querySelector('body').style.overflow = 'hidden';
                        } else {
                            document.querySelector('body').style.overflow = 'scroll';
                        }
                    },
                    switchTab: function(tabNumber) {
                        this.ntfItems = [];
                        this.tab = tabNumber;
                        if (this.tab === 0) {
                            this._fetchEventItems();
                        } else if (this.tab === 1) {
                            this._fetchVisitorItems();
                            this.existNonCheckedVisitor = false;
                        }
                    },
                    showPopup: function(popupType) {
                        var vm = this;
                        Object.keys(vm.popupOpening).forEach(function(key) {
                            if (key === popupType) {
                                vm.$set(vm.popupOpening, key, !vm.popupOpening[key]);
                            } else {
                                vm.$set(vm.popupOpening, key, false);
                            }
                        });

                        if (popupType === 'notification' & amp; & amp; vm.popupOpening['notification'] === true) {
                            this.tab = 0;
                            this._fetchEventItems();
                        }
                    },
                    markAsRead: function() {
                        var vm = this;
                        $.ajax({
                                url: '/notifications/mark',
                                dataType: 'json',
                                data: {},
                            })
                            .done(function(data) {
                                vm.ntfItems.forEach(function(item, i) {
                                    vm.ntfItems[i].read = '';
                                });
                            });
                    },
                    _fetchEventItems: function() {
                        var vm = this;
                        $.ajax({
                            url: '/notifications/event_items',
                            type: 'GET',
                            data: {
                                offset: 0,
                                limit: 20,
                            },
                        }).done(function(resp) {
                            vm.ntfItems = resp.items;
                        });
                    },
                    _fetchVisitorItems: function() {
                        var vm = this;
                        $.ajax({
                            url: '/notifications/visitor_items',
                            type: 'GET',
                            data: {
                                offset: 0,
                                limit: 20,
                            },
                        }).done(function(resp) {
                            vm.ntfItems = resp.items;
                        });
                    }
                }
            });
        </script>

        <div id="pjax-wrapper">
            <div id="video-to-gif-wrap" style="min-height: 735px;">
                <div class="video-to-gif-init">
                    <div class="video-to-gif-init-header"><img src="https://img.gifmagazine.net/gifmagazine/000assets/images/v2/GIFMAKER.svg" /></div>
                    <div class="video-to-gif-init-body">
                        <section>
                            <div class="video-to-gif-init-body-cameraroll">
                                <div class="video-to-gif-init-body-cameraroll-body-btn"><a href="javascript:void(0)" rel="nofollow"><span>動画 → GIF</span> <input type="file" name="cameraFile" accept="video/*" id="video-to-gif-init-body-cameraroll-body-btn-input-file" /></a></div>
                            </div>
                        </section>
                        <section>
                            <div class="video-to-gif-init-body-url">
                                <div class="video-to-gif-init-body-url-body-btn"><a href="/converters/youtube_to_gif?locale=ja"><span>Youtube → GIF</span></a></div>
                            </div>
                        </section>
                        <section>
                            <div class="video-to-gif-init-body-picture">
                                <div class="video-to-gif-init-body-picture-body-btn"><a href="/converters/image_to_gif?locale=ja"><span>画像 → GIF</span></a></div>
                            </div>
                        </section>
                    </div>
                </div>
                <div class="video-to-gif-editor from-cameraroll" style="display: none;">
                    <div class="video-to-gif-editor-wrap">
                        <div id="video-to-gif-editor-wrap-video" class="video-to-gif-editor-wrap-video"></div>
                        <div class="video-to-gif-editor-wrap-meta">
                            <div class="video-to-gif-editor-wrap-errors" style="display: none;"><span>エラーが発生しました <span></span></span></div>
                            <div class="video-to-gif-editor-wrap-durations">
                                <div class="video-to-gif-editor-wrap-durations-title"><span>1. 長さを選択してください</span></div>
                                <div class="video-to-gif-editor-wrap-durations-btns">
                                    <div class="video-to-gif-editor-wrap-durations-btns-inner"><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on5">0.5秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on10">1秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on15">1.5秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on20">2秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on25">2.5秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn active on30">3秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on35">3.5秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on40">4秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on45">4.5秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on50">5秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on55">5.5秒</a><a href="javascript:void(0);" class="video-to-gif-editor-wrap-durations-btn on60">6秒</a></div>
                                </div>
                            </div>
                            <div class="video-to-gif-editor-wrap-slider">
                                <div class="video-to-gif-editor-wrap-slider-title"><span>2. 緑色のバーを横にスクロールしてスタート位置を決めてください</span>
                                    <div class="video-to-gif-editor-wrap-slider-title-time"><span>00:00:00</span></div>
                                </div>
                                <div class="video-to-gif-editor-wrap-slider-range">
                                    <div class="video-to-gif-editor-wrap-slider-range-inner">
                                        <div class="video-to-gif-editor-wrap-slider-range-inner-bar">
                                            <div class="video-to-gif-editor-wrap-slider-range-inner-bar-main"></div>
                                        </div>
                                    </div>
                                    <div class="video-to-gif-editor-wrap-slider-range-center"></div> <button type="button" class="pn-Advancer pn-Advancer_Left"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 551 1024" class="pn-Advancer_Icon">
                                            <path d="M445.44 38.183L-2.53 512l447.97 473.817 85.857-81.173-409.6-433.23v81.172l409.6-433.23L445.44 38.18z" />
                                        </svg></button> <button type="button" class="pn-Advancer pn-Advancer_Right"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 551 1024" class="pn-Advancer_Icon">
                                            <path d="M105.56 985.817L553.53 512 105.56 38.183l-85.857 81.173 409.6 433.23v-81.172l-409.6 433.23 85.856 81.174z" />
                                        </svg></button>
                                </div>
                            </div>
                            <div class="video-to-gif-editor-wrap-submit"><a href="javascript:void(0)" class="video-to-gif-editor-wrap-submit-btn">
                                    変換する
                                </a></div>
                            <div class="video-to-gif-editor-wrap-links"><a href="/converters/movie_to_gif?locale=ja">TOPに戻る</a></div>
                        </div>
                    </div>
                </div>
                <div class="video-to-gif-loading" style="display: none;">
                    <div class="video-to-gif-loading-inner">
                        <div class="video-to-gif-loading-inner-msg">

                        </div>
                        <div class="video-to-gif-loading-inner-icon">
                            <div class="video-to-gif-loading-inner-icon-inner"></div>
                        </div>
                    </div>
                </div>
                <div class="video-to-gif-finish" style="display: none;">
                    <div class="video-to-gif-finish-img"><img src="" /></div>
                    <div class="video-to-gif-finish-share">
                        <div class="video-to-gif-finish-share-download-bar"><a rel="nofollow" href="" download="" onclick="ga('send','event','engagement','sns_button','download_id:_'+location.href.replace(location.origin, ''));" target="_blank"><i class="fa fa-download"></i><span>ダウンロード</span></a>
                            <p>
                                ※ダウンロードできない時は画像を右クリックして保存してください
                            </p>
                        </div>
                    </div>
                    <div class="video-to-gif-finish-links"><a href="/converters/movie_to_gif?locale=ja">TOPに戻る</a></div>
                </div> <input id="video-to-gif-wrap-hidden-token" type="hidden" name="token" value="" /> <input id="video-to-gif-wrap-hidden-uid" type="hidden" name="uid" value="" />
            </div>

            <script>
                var sliderWidth = 50;
                new Vue({
                    el: "#video-to-gif-wrap",
                    data: {
                        // 共通
                        initPageOpen: true,
                        editorPageOpen: false,
                        loadingPageOpen: false,
                        finishPageOpen: false,
                        videoElm: null,
                        player: null,
                        convertSource: "",
                        errorOccuring: false,
                        errorMsg: "",
                        userId: "",
                        token: "",
                        // フェーズ1
                        camerarollFile: null,
                        youtubeUrl: null,
                        invalidIUrl: false,
                        // フェーズ2
                        seconds: [0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6],
                        duration: 3, // seconds, not mill seconds
                        sliderMin: 0,
                        sliderMax: 100,
                        sliderValue: 0,
                        sliderBarWidth: 0,
                        sliderMemori: 0,
                        sliderBtnTimer: null,
                        timer: null,
                        sliderTimer: null,
                        ytDone: false,
                        loadingMsg: "",
                        loadingTimer: null,
                        videoEndTime: 0,
                        // フェーズ3
                        generatedImg: "",
                        downloadImg: "",
                    },
                    created: function() {
                        if (location.search.match(/locale=en/)) {
                            document.querySelector('.video-to-gif-finish-share-download-bar-wrap').classList.add('en')
                        }
                    },
                    mounted: function() {
                        if (location.pathname.match(/youtube/)) {
                            document.querySelector("#video-to-gif-wrap").style["min-height"] = window.innerHeight - 54 + "px";
                            document.querySelector(".video-to-gif-init").style["padding"] = "0px 35px 0 35px";
                            document.querySelector("#wrapper").style["margin-top"] = "0px";
                            document.querySelector(".video-to-gif-init-body").style["margin-top"] = "0px";
                        } else {
                            document.querySelector("#video-to-gif-wrap").style["min-height"] = window.innerHeight + "px";
                        }
                        this._sliderChangeHandler();
                        this._loadYTIframeScript();
                        this._initParameters();
                    },
                    watch: {
                        errorOccuring: function() {
                            if (this.errorOccuring === true) {
                                this.loadingPageOpen = false;
                            }
                        },
                        errorMsg: function() {
                            this.loadingPageOpen = false;
                        },
                        tags: function() {
                            if (this.tags.length & gt; 24) {
                                this.tags = this.tags.slice(0, 24);
                                alert("タグの追加上限です")
                            }
                        },
                    },
                    computed: {
                        sliderCurrentTime: function() {
                            if (this.sliderValue & lt; 0) return "00:00:00";
                            if (this.sliderValue & gt; this.sliderMax) {
                                var hours = Math.floor(this.sliderMax / (60 * 60));
                                var minutes = Math.floor(this.sliderMax / 60) % 60;
                                var seconds = Math.floor(this.sliderMax - Math.floor(this.sliderMax / 60) * 60);
                                return ("0" + hours).slice(-1 * 2) + ":" + ("0" + minutes).slice(-1 * 2) + ":" + ("0" + seconds).slice(-1 * 2);
                            }

                            var hours = Math.floor(this.sliderValue / (60 * 60));
                            var minutes = Math.floor(this.sliderValue / 60) % 60;
                            var seconds = this.sliderValue - minutes * 60;
                            var miliseconds = seconds - Math.floor(seconds);
                            seconds = Math.floor(seconds);
                            return ("0" + hours).slice(-1 * 2) + ":" + ("0" + minutes).slice(-1 * 2) + ":" + ("0" + seconds).slice(-1 * 2) + ("" + miliseconds).replace(/^0/, '').slice(0, 2);
                        },
                    },
                    methods: {
                        //初期化
                        _initParameters: function() {
                            var vm = this;
                            $.ajax({
                                url: "/converters/init",
                                type: 'get',
                            }).done(function(resp) {
                                vm.userId = resp.user_id;
                                vm.token = resp.token;
                            }).fail(function() {});
                        },
                        // フェーズ1 CB:
                        clickCamerarollBtn: function(e) {
                            e.preventDefault();
                            var vm = this;
                            var files = e.target.files
                            if (files.length & gt; 0) {
                                var timer = this._startLoagingMsgs(["Loading..."]);
                                var file = files[0];
                                var filereader = new FileReader();
                                filereader.onload = function(e) {
                                    vm._createVideoElement(file);
                                    vm.initPageOpen = false;
                                    vm.editorPageOpen = true;
                                    vm.loadingPageOpen = false;
                                    clearTimeout(timer);
                                }
                                filereader.readAsDataURL(file);
                            }
                        },
                        // フェーズ1 YT:
                        clickYoutubeUrlBtn: function() {
                            if (this.youtubeUrl & amp; & amp; this.youtubeUrl.match(/(http[s]*:\/\/[\w]*[.]*youtube\.com|https:\/\/youtu\.be)/)) {
                                var m = this.youtubeUrl.match(/v=([^&amp;]+)/);
                                if (m !== null) {
                                    this.youtubeUrl = "https://www.youtube.com/watch?v=" + m[1];
                                    this.invalidIUrl = false;
                                    this.convertSource = "yt"; // 重要
                                    this._createYTIframeElement();
                                    return true;
                                }

                                var mm = this.youtubeUrl.match(/https:\/\/youtu\.be\/([^\?]+)/);
                                if (mm !== null) {
                                    this.youtubeUrl = "https://www.youtube.com/watch?v=" + mm[1];
                                    this.invalidIUrl = false;
                                    this.convertSource = "yt"; // 重要
                                    this._createYTIframeElement();
                                    return true;
                                }
                            }

                            this.invalidIUrl = true;
                            return false;
                        },
                        // フェーズ1 CB:
                        // ごりごりvideoエレメントを作ってappendしないとうまくfileをロードしてくれないのでこのやり方してる
                        _createVideoElement: function(file) {
                            var vm = this;
                            // create video element
                            var e_video = document.createElement('video');
                            e_video.setAttribute('id', 'video-to-gif-editor-wrap-video-main');
                            document.querySelector('.video-to-gif-editor-wrap-video').appendChild(e_video);
                            // set video attributes
                            e_video.autoplay = true;
                            e_video.muted = true;
                            e_video.loop = true;
                            e_video.setAttribute("playsinline", "");
                            e_video.setAttribute("webkit-playsinline", "");
                            // create video source
                            var e_video_src = document.createElement('source');
                            e_video_src.setAttribute('src', window.URL.createObjectURL(file));
                            var fileType = file.type;
                            if (file.type == 'video/quicktime') fileType = 'video/mp4';
                            e_video_src.setAttribute('type', fileType);
                            document.getElementById('video-to-gif-editor-wrap-video-main').appendChild(e_video_src);
                            this.videoElm = e_video;

                            // durationを取得するためにはmetadataの取得完了を待たないとだめ
                            // よって、イベントが発生してからスライダーのセット等を行う
                            e_video.addEventListener('loadedmetadata', function() {
                                vm._setSliderValue(e_video.duration);
                                vm._loopHandler(vm.sliderValue, vm.convertSource);
                                vm._centerizeDurationBtn();
                            });
                        },
                        // フェーズ1 YT: youtubeのiframe apiのscriptを読み込んでおく
                        _loadYTIframeScript: function() {
                            // loads the IFrame Player API code asynchronously.
                            var tag = document.createElement('script');
                            tag.src = "https://www.youtube.com/iframe_api";
                            var firstScriptTag = document.getElementsByTagName('script')[0];
                            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
                        },
                        // フェーズ1 YT: Youtubeのiframeエレメントを作成する
                        _createYTIframeElement: function() {
                            // create iframe
                            var vm = this;
                            this.player = new YT.Player('video-to-gif-editor-wrap-video', {
                                width: "100%",
                                height: 180,
                                videoId: vm._getYTVideoId(),
                                playerVars: {
                                    playsinline: 1,
                                    modestbranding: 1,
                                    autohide: 1,
                                    showinfo: 0,
                                    controls: 0
                                },
                                events: {
                                    'onReady': this._onYTPlayerReady,
                                    'onStateChange': this._onYTPlayerStateChange
                                }
                            });
                        },
                        // フェーズ1 YT: youtube videoがロードされるのを待つ
                        _onYTPlayerReady: function(event) {
                            event.target.playVideo();
                            event.target.mute();
                            this._onYTPlayerStateChange(event);
                            this.initPageOpen = false;
                            this.editorPageOpen = true;
                        },
                        // フェーズ1 YT: youtubeのvideoの状態変化を監視する
                        _onYTPlayerStateChange: function(event) {
                            var vm = this;
                            if (event.data == YT.PlayerState.PLAYING & amp; & amp; !this.ytDone) {
                                vm._setSliderValue(event.target.getDuration());
                                vm._loopHandler(vm.sliderValue, vm.convertSource);
                                this.ytDone = true;
                                vm._centerizeDurationBtn();
                            }
                        },
                        // フェーズ1 YT: Youtubeのvideo_idを取得
                        _getYTVideoId: function() {
                            var m = null;
                            if (this.youtubeUrl === null) return "";
                            if (this.youtubeUrl.match(/youtu\.be\/(.+)[?]*/)) {
                                m = this.youtubeUrl.match(/youtu\.be\/(.+)[?]*/);
                            } else {
                                m = this.youtubeUrl.match(/v=([^&amp;]+)/);
                            }
                            if (m !== null) {
                                return m[1];
                            }
                            return "";
                        },
                        // フェーズ1: 再生時間を設定
                        // 再生時間に合わせてsliderの長さを変更
                        _setSliderValue: function(duration) {
                            var wrapElm = document.querySelector(".video-to-gif-editor-wrap-slider-range-inner-bar");
                            var mainElm = document.querySelector(".video-to-gif-editor-wrap-slider-range-inner-bar-main");
                            var centerElm = document.querySelector(".video-to-gif-editor-wrap-slider-range-center");
                            this.sliderBarWidth = duration * sliderWidth;
                            // かなり短い動画の場合はsliderWidthを改変してメモリをでかくする
                            if (duration & lt; 4) {
                                sliderWidth = 300;
                                this.sliderBarWidth = duration * sliderWidth;
                            } else if (window.innerWidth & lt; this.sliderBarWidth) {
                                // 端末の横幅より大きい場合は端末の横幅分だけスクロールできれば良い
                                var rangebarWidth = document.querySelector('.video-to-gif-editor-wrap-slider-range-inner').offsetWidth
                                mainElm.style.width = this.sliderBarWidth + "px";
                                wrapElm.style.width = (this.sliderBarWidth + rangebarWidth) + "px";
                            } else {
                                // 端末の横幅より小さいがdurationが4秒以上の場合は適当に2.3倍にする
                                mainElm.style.width = this.sliderBarWidth + "px";
                                wrapElm.style.width = (this.sliderBarWidth * 2.3) + "px";
                            }
                            // センターのバーの位置設定とそれに合わせたバーの位置設定
                            var centerBarOffset = ((document.querySelector(".video-to-gif-editor-wrap-meta").offsetWidth / 2) - 20);
                            centerElm.style.left = centerBarOffset + "px";
                            mainElm.style["margin-left"] = centerBarOffset + "px";

                            // px/0.1秒の長さを計算 =&gt; 要は0.1秒あたり何pxかという値
                            // 左右に移動するボタンでバーを動かす時に使う
                            this.sliderMemori = (this.sliderBarWidth / duration) * 0.1;
                            this.sliderValue = 0;
                            this.sliderMax = duration;
                            var hours = Math.floor(duration / (60 * 60))
                            var minutes = Math.floor(duration / 60) % 60
                            var seconds = Math.floor(duration - (Math.floor(duration / 60)) * 60)
                            this.videoEndTime = ("0" + hours).slice(-1 * 2) + ":" + ("0" + minutes).slice(-1 * 2) + ":" + ("0" + seconds).slice(-1 * 2);
                        },
                        // フェーズ1 共通: 秒数のボタンをセンターにする
                        _centerizeDurationBtn: function() {
                            document.querySelector(".video-to-gif-editor-wrap-durations-btns").scrollLeft = (document.querySelector(".video-to-gif-editor-wrap-durations-btn.active").clientWidth + 10) * 3
                        },

                        // フェーズ2 共通: スライダーの値を増加させるボタン
                        slideToRight: function() {
                            var vm = this;
                            if (!vm.sliderBtnTimer) {
                                var elm = document.querySelector(".video-to-gif-editor-wrap-slider-range-inner");
                                vm.sliderBtnTimer = setInterval(function() {
                                    elm.scrollLeft = (elm.scrollLeft + vm.sliderMemori);
                                    vm.sliderValue += 0.1;
                                }, 30);
                            }
                        },
                        // フェーズ2 共通: スライダーの値を減少させるボタン
                        slideToLeft: function() {
                            var vm = this;
                            if (!vm.sliderBtnTimer) {
                                var elm = document.querySelector(".video-to-gif-editor-wrap-slider-range-inner");
                                vm.sliderBtnTimer = setInterval(function() {
                                    elm.scrollLeft = (elm.scrollLeft - vm.sliderMemori);
                                    vm.sliderValue -= 0.1;
                                }, 30);
                            }
                        },
                        stopSliderBtn: function() {
                            clearTimeout(this.sliderBtnTimer);
                            this.sliderBtnTimer = false;
                            this._loopHandler(this.sliderValue, this.convertSource);
                        },
                        // フェーズ2 共通: 長さを設定するボタン
                        clickDurationBtn: function(time) {
                            var vm = this;
                            vm.duration = time;
                            // activeクラスをつけてハイライト
                            document.querySelectorAll(".video-to-gif-editor-wrap-durations-btn").forEach(function(elm) {
                                elm.classList.remove('active')
                            });
                            document.querySelector(".video-to-gif-editor-wrap-durations-btn.on" + time * 10).classList.add('active');
                            vm._loopHandler(vm.sliderValue, vm.convertSource);
                        },
                        // フェーズ2 共通: 変換開始するボタン
                        clickStartConvertingBtn: function() {
                            var vm = this;
                            this._startLoagingMsgs(["動画の切り出しを行なっています...", "もうすぐ切り出しが終わります...", "GIFアニメに変換しています...", "もうすぐ完成します..."]);

                            if (vm.convertSource === "yt") {
                                $.ajax({
                                    url: "https://converter.gifmagazine.net/youtube/sp/convert",
                                    type: 'POST',
                                    data: {
                                        yt_url: vm.youtubeUrl,
                                        start_sec: vm.sliderValue,
                                        duration: vm.duration,
                                        uid: vm.userId,
                                        token: vm.token,
                                    },
                                }).done(function(resp) {
                                    if (resp.error) {
                                        vm.errorOccuring = true;
                                        vm.errorMsg = resp.error;
                                        return false;
                                    }

                                    vm.generatedImg = resp.image_url;
                                    vm.downloadImg = "https://gifmagazine.net/post_images/" + resp.id + "/download?token=" + vm.token;
                                    vm.initPageOpen = false;
                                    vm.editorPageOpen = false;
                                    vm.loadingPageOpen = false;
                                    vm.finishPageOpen = true;
                                    clearTimeout(vm.timer); // リソースを無駄に使わないように止める
                                    clearTimeout(vm.loadingTimer); // リソースを無駄に使わないように止める
                                    ga('send', 'event', 'creator', 'create', 'create_movie_to_gif');
                                }).fail(function(data) {
                                    vm.errorOccuring = true;
                                });
                            } else {
                                var formData = new FormData();
                                var fileElm = document.querySelector("#video-to-gif-init-body-cameraroll-body-btn-input-file");
                                formData.append("video", fileElm["files"][0])
                                formData.append("start_time", vm.sliderValue);
                                formData.append("end_time", parseFloat(vm.sliderValue) + parseFloat(vm.duration));
                                formData.append("token", vm.token);
                                $.ajax({
                                    url: "https://converter.gifmagazine.net/local_video/convert",
                                    method: "post",
                                    processData: false,
                                    contentType: false,
                                    timeout: 120000,
                                    data: formData,
                                }).done(function(resp) {
                                    vm.generatedImg = "data:image/gif;base64," + resp.data;
                                    vm.downloadImg = "data:image/gif;base64," + resp.data;
                                    vm.initPageOpen = false;
                                    vm.editorPageOpen = false;
                                    vm.loadingPageOpen = false;
                                    vm.finishPageOpen = true;
                                    // 作成とアップロードが同時に起こってるので同時に計測
                                    ga('send', 'event', 'creator', 'create', 'create_youtube_to_gif');
                                    ga('send', 'event', 'creator', 'post', 'post_youtube_to_gif');
                                }).fail(function(data) {
                                    vm.errorOccuring = true;
                                });
                            }
                        },
                        // フェーズ2 共通: スライダーの変更でループ再生を発火させるハンドラ
                        _sliderChangeHandler: function() {
                            var vm = this;
                            document.querySelector(".video-to-gif-editor-wrap-slider-range-inner").onscroll = function() {
                                var currentTime = this.scrollLeft / sliderWidth;
                                vm._loopHandler(currentTime, vm.convertSource);
                            }
                        },
                        // フェーズ2 共通: ループを管理するハンドラ
                        _loopHandler: function(currentTime, source) {
                            var vm = this;
                            clearInterval(vm.timer);
                            clearTimeout(vm.sliderTimer);
                            vm.errorOccuring = false;
                            vm.sliderValue = currentTime;

                            // youtubeとcamerarollからのタイプで分ける
                            if (source === "yt") {
                                vm.sliderTimer = setTimeout(function() {
                                    vm.player.seekTo(currentTime, true)
                                }, 100);
                                vm.timer = setInterval(function() {
                                    vm._loopForYT(currentTime, vm.duration)
                                }, parseFloat(vm.duration) * 1000);
                            } else {
                                vm.videoElm.currentTime = currentTime;
                                vm.videoElm.play();
                                vm.timer = setInterval(function() {
                                    vm._loopForCameraroll(currentTime, vm.duration)
                                }, parseFloat(vm.duration) * 1000);
                            }
                        },
                        // フェーズ2 CB: camerarollからアップロードされたvideoのループ処理
                        _loopForCameraroll: function(currentTime, duration) {
                            console.log("Cameraroll_LoopHander: currentTime " + currentTime + ", duration " + duration);
                            this.videoElm.currentTime = currentTime;
                            this.videoElm.play();
                        },
                        // フェーズ2 YT: camerarollからアップロードされたvideoのループ処理
                        _loopForYT: function(currentTime, duration) {
                            console.log("YT_LoopHander: currentTime " + currentTime + ", duration " + duration);
                            this.player.seekTo(currentTime, true);
                        },
                        // フェーズ2 YT: ローディングメッセージを変えたり変えなかったりできる
                        _startLoagingMsgs: function(messages) {
                            var vm = this;
                            vm.loadingPageOpen = true;
                            vm.loadingMsg = messages.shift()
                            if (messages.length & gt; 0) {
                                vm.loadingTimer = setInterval(function() {
                                    if (messages.length & gt; 0) {
                                        vm.loadingMsg = messages.shift();
                                    }
                                }, 10000);
                            }

                            // ローディングバーのアニメーション
                            var elm = document.querySelector(".video-to-gif-loading-inner-icon-inner");
                            var width = 1;
                            var id = setInterval(frame, 300);
                            elm.style.width = width + '%';

                            function frame() {
                                if (width & gt; = 99) {
                                    clearInterval(id);
                                } else {
                                    width++;
                                    elm.style.width = width + '%';
                                }
                            }

                            return id;
                        },
                        // フェーズ3:
                        startLongTap: function() {
                            ga('send', 'event', 'engagement', 'download', 'download_PressAndHold_id:' + '_' + location.href.replace(location.origin, ''));
                        },
                    }
                })
            </script>


        </div>

        <div id="pjax-loading-wrap">
            <div class="inner">
                <i class="fa-li fa fa-spinner fa-spin"></i>
            </div>
        </div>

        <script>
            window.onscroll = function() {
                switchHeaderBorder();
            }
            switchHeaderBorder();

            // ヘッダーのshadowをごにょごにょする
            function switchHeaderBorder() {
                var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                if (document.querySelector("#home20160502-header")) {
                    if (scrollTop & gt; 38) {
                        document.querySelector("#home20160502-header").classList.remove('border-line');
                    } else {
                        document.querySelector("#home20160502-header").classList.add('border-line');
                    }
                }
            }
        </script>


        <script>
            Vue.component('follow-buttons', {
                template: `
    &lt;div class="header20160502-wrap-right-inner-notification-popup-vtitem-right"&gt;
      &lt;button
        class="header20160502-wrap-right-inner-notification-popup-vtitem-right-follow"
        href="javascript:void(0)"
        v-if="following_status === 2"
        @click="clickUnfollowBtn(item.visitor_id)"&gt;
        フォロー中
      &lt;/button&gt;
      &lt;button
        class="header20160502-wrap-right-inner-notification-popup-vtitem-right-follow follow"
        href="javascript:void(0)"
        v-if="following_status === 3"
        @click="clickFollowBtn(item.visitor_id)"&gt;
        フォローする
      &lt;/button&gt;
    &lt;/div&gt;
  `,
                props: ['item'],
                data: function() {
                    return {
                        item: this.item,
                        following_status: 0,
                    }
                },
                mounted() {
                    if (this.item.is_following) {
                        this.following_status = 2;
                    } else {
                        this.following_status = 3;
                    }
                },
                methods: {
                    clickFollowBtn: function(id) {
                        var vm = this;
                        vm.following_status = 2;
                        $.ajax({
                            url: "/users/" + id + "/follow",
                            method: "POST",
                            dataType: 'json',
                        }).done(function(resp) {}).fail(function() {
                            vm.following_status = 3;
                        });
                    },
                    clickUnfollowBtn: function(id) {
                        var vm = this;
                        vm.following_status = 3
                        $.ajax({
                            url: "/users/" + id + "/unfollow",
                            method: "POST",
                            dataType: 'json',
                        }).done(function(resp) {}).fail(function() {
                            vm.following_status = 2;
                        });
                    },
                }
            })

            new Vue({
                el: '#header',
                data: {
                    tab: 0,
                    popupOpening: {
                        notification: false,
                        generator: false,
                        upload: false,
                        profile: false,
                        left: false,
                        searchbox: false,
                        thegifs: false,
                    },
                    ntfItems: [],
                    existNonCheckedVisitor: false,
                },
                mounted() {
                    this._checkUnreadVisitor();
                    this._hideSnackNotice();

                    // autocomplete
                    $('#search-box-input').typeahead({
                        name: "gif",
                        remote: "/gifs/autocomplete.json?query=%QUERY",
                        highlight: true,
                        minLength: 2,
                    }).on('typeahead:selected', function(e, data) {
                        e.target.form.submit();
                    });
                },
                watch: {
                    "popupOpening.notification": function() {
                        this.handlePopupScroll();
                    },
                },
                methods: {
                    handlePopupScroll: function() {
                        if (this.popupOpening.notification === true) {
                            document.querySelector('body').style.overflow = 'hidden';
                        } else {
                            document.querySelector('body').style.overflow = 'scroll';
                        }
                    },
                    switchTab: function(tabNumber) {
                        this.ntfItems = [];
                        this.tab = tabNumber;
                        if (this.tab === 0) {
                            this._fetchEventItems();
                        } else if (this.tab === 1) {
                            this._fetchVisitorItems();
                            this.existNonCheckedVisitor = false;
                        }
                    },
                    showPopup: function(popupType) {
                        var vm = this;
                        Object.keys(vm.popupOpening).forEach(function(key) {
                            if (key === popupType) {
                                vm.$set(vm.popupOpening, key, !vm.popupOpening[key]);
                            } else {
                                vm.$set(vm.popupOpening, key, false);
                            }
                        });

                        if (popupType === 'notification' & amp; & amp; vm.popupOpening['notification'] === true) {
                            this.tab = 0;
                            this._fetchEventItems();
                        }
                    },
                    markAsRead: function() {
                        var vm = this;
                        $.ajax({
                                url: '/notifications/mark',
                                dataType: 'json',
                                data: {},
                            })
                            .done(function(data) {
                                vm.ntfItems.forEach(function(item, i) {
                                    vm.ntfItems[i].read = '';
                                });
                            });
                    },
                    closeSearchBox: function() {
                        this.showPopup('searchbox');
                    },
                    _fetchEventItems: function() {
                        var vm = this;
                        $.ajax({
                            url: '/notifications/event_items',
                            type: 'GET',
                            data: {
                                offset: 0,
                                limit: 20,
                            },
                        }).done(function(resp) {
                            vm.ntfItems = resp.items;
                        });
                    },
                    _fetchVisitorItems: function() {
                        var vm = this;
                        $.ajax({
                            url: '/notifications/visitor_items',
                            type: 'GET',
                            data: {
                                offset: 0,
                                limit: 20,
                            },
                        }).done(function(resp) {
                            vm.ntfItems = resp.items;
                        });
                    },
                    _checkUnreadVisitor: function() {
                        if (this._getCookie() !== "1") {
                            this._setCookie();
                            this.existNonCheckedVisitor = true;
                        }
                    },
                    _hideSnackNotice: function() {
                        setTimeout(function() {
                            var elms = document.querySelectorAll('.snack-bar-notice')
                            for (var i = 0; i & lt; elms.length; i++) {
                                elms[i].classList.add('hide')
                            }
                        }, 10000)
                    },
                    _getCookie: function() {
                        return unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)" + escape(this._visitorCookieKey()).replace(/[\-\.\+\*]/g, "\\$&amp;") + "\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"), "$1"));
                    },
                    _setCookie: function() {
                        document.cookie = this._visitorCookieKey() + "=" + "1" + "; max-age=" + (60 * 60 * 24) + ";";
                    },
                    _visitorCookieKey: function() {
                        return "visitor_checked";
                    },
                }
            });
        </script>

    </div>

    <footer class="global-footer fixed off">
        <small>
            <a href="/?locale=ja">© 2012-2023 GIFMAGAZINE</a>
            <br />
            <span> | </span>
            <a href="?locale=ja">日本語</a><span> | </span>
            <a href="?locale=en">English</a><span> | </span>
            <a href="?locale=zh-TW">繁體中文</a><span> | </span>
        </small>
    </footer>



</body>

</html>
